{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://redletters.dev/schemas/bundle-v1.0.0.schema.json",
  "title": "Research Bundle Manifest",
  "description": "Schema for research bundle manifest (v0.12.0) - deterministic scholarly export package",
  "type": "object",
  "required": [
    "schema_version",
    "tool_version",
    "created_utc",
    "lockfile_hash",
    "snapshot_hash",
    "artifacts"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "description": "Bundle manifest schema version",
      "const": "1.0.0"
    },
    "tool_version": {
      "type": "string",
      "description": "Version of the redletters tool that created this bundle",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
    },
    "created_utc": {
      "type": "string",
      "description": "ISO 8601 timestamp of bundle creation (UTC)",
      "format": "date-time"
    },
    "lockfile_hash": {
      "type": "string",
      "description": "SHA-256 hash of the included lockfile.json",
      "pattern": "^[0-9a-f]{64}$"
    },
    "snapshot_hash": {
      "type": "string",
      "description": "SHA-256 hash of the included snapshot.json",
      "pattern": "^[0-9a-f]{64}$"
    },
    "artifacts": {
      "type": "array",
      "description": "List of artifacts in the bundle (sorted by artifact_type then path)",
      "items": {
        "$ref": "#/$defs/artifact_entry"
      },
      "minItems": 1
    },
    "content_hash": {
      "type": "string",
      "description": "SHA-256 hash of all artifact hashes concatenated (deterministic bundle fingerprint)",
      "pattern": "^[0-9a-f]{64}$"
    },
    "schemas_included": {
      "type": "boolean",
      "description": "Whether JSON schema files are included in the bundle"
    },
    "notes": {
      "type": "string",
      "description": "Optional user-provided notes about this bundle"
    }
  },
  "$defs": {
    "artifact_entry": {
      "type": "object",
      "required": ["path", "artifact_type", "sha256"],
      "properties": {
        "path": {
          "type": "string",
          "description": "Relative path within the bundle"
        },
        "artifact_type": {
          "type": "string",
          "enum": [
            "apparatus",
            "citations",
            "dossier",
            "lockfile",
            "quote",
            "schema",
            "snapshot",
            "translation"
          ],
          "description": "Type of artifact"
        },
        "schema_version": {
          "type": "string",
          "description": "Schema version of this artifact",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$"
        },
        "sha256": {
          "type": "string",
          "description": "SHA-256 hash of the file contents",
          "pattern": "^[0-9a-f]{64}$"
        }
      }
    }
  }
}
